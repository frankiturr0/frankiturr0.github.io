---
title: "Senado"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE)
```
### Cámara de Senadores dividida POR BLOQUE

```{r, echo=FALSE}

library(tidyverse)
library(plyr)
library(ggparliament)
library(readxl)
library(ggthemes)
library(plotly)
library(readr)
library(dplyr)
library(ggplot2)
library(geofacet)
library(data.table)
library(highcharter)
library(scales)
library(paletteer)
library(gganimate)
library(kableExtra)
senado_nomina <- read_excel("C:/Users/fefen/OneDrive/Documentos/RSTUDIO/data/DIPUTADOS/senado_nomina.xlsx")

#NOMBRES DE COLUMNAS
colnames(senado_nomina)[1] <- "Distrito"
colnames(senado_nomina)[2] <- "Nombre"
colnames(senado_nomina)[3] <- "Apellido"
colnames(senado_nomina)[4] <- "party_long"

#PARTIDOS
senado_nomina <- senado_nomina %>% mutate(
     seats = case_when(
       party_long == "Unidad Ciudadana"        ~ "1",
       party_long == "Frente Nacional y Popular"        ~ "1",
       party_long == "Frente Renovador de la Concordia Social"        ~ "1",
       party_long == "Juntos Somos Río Negro"        ~ "1",
       party_long == "Unidad Federal"        ~ "1",
        party_long == "Por Santa Cruz"~ "1",
       party_long == "Unión Cívica Radical"        ~ "1",
       party_long == "Partido por la Justicia Social"        ~ "1",
      party_long == "Frente PRO"        ~ "1",
      party_long == "Cambio Federal"        ~ "1",
      party_long == "La Libertad Avanza"        ~ "1",
       ))

senado_nomina$seats <- as.double(senado_nomina$seats)

#COLORES
senado_nomina <- senado_nomina %>% mutate(
     colour = case_when(
       party_long == "Unidad Ciudadana"        ~ "#1c60ff",
       party_long == "Frente Nacional y Popular"        ~ "#4FA4FF",
       party_long == "Frente Renovador de la Concordia Social"        ~ "#A9D3FF",
       party_long == "Juntos Somos Río Negro"        ~ "#42ED3D",
       party_long == "Unidad Federal"        ~ "#2E1093",
        party_long == "Por Santa Cruz"~ "#150A3E",
       party_long == "Unión Cívica Radical"        ~ "#C70039",
       party_long == "Partido por la Justicia Social"        ~ "#A88C43",
      party_long == "Frente PRO"        ~ "#FFEC2D",
      party_long == "Cambio Federal"        ~ "#FF8221",
      party_long == "La Libertad Avanza"        ~ "#9143A8",
       ))

senado_nomina <- senado_nomina %>% mutate(
     orden = case_when(
      party_long == "Unidad Ciudadana"        ~ "1",
       party_long == "Frente Nacional y Popular"        ~ "2",
       party_long == "Frente Renovador de la Concordia Social"        ~ "3",
       party_long == "Juntos Somos Río Negro"        ~ "4",
        party_long == "Unidad Federal"        ~ "5",
       party_long == "Por Santa Cruz"        ~ "6",
       party_long == "Unión Cívica Radical"        ~ "7",
       party_long == "Partido por la Justicia Social"        ~ "8",
       party_long == "Frente PRO"        ~ "9",
       party_long == "Cambio Federal"        ~ "10",
       party_long == "La Libertad Avanza"        ~ "11",
       ))

senado_nomina$orden <- as.double(senado_nomina$orden)

senado_nomina$party_long <- factor(as.character(senado_nomina$party_long), levels=c("Unidad Ciudadana","Frente Nacional y Popular","Frente Renovador de la Concordia Social","Juntos Somos Río Negro","Unidad Federal","Por Santa Cruz","Unión Cívica Radical","Partido por la Justicia Social","Frente PRO","Cambio Federal","La Libertad Avanza"), labels = c("Unidad Ciudadana","Frente Nacional y Popular","Frente Renovador de la Concordia Social","Juntos Somos Río Negro","Unidad Federal","Por Santa Cruz","Unión Cívica Radical","Partido por la Justicia Social","Frente PRO","Cambio Federal","La Libertad Avanza"))

senadores_por_bloque<- ggparliament::parliament_data(senado_nomina, #datos 
                                                       type = "semicircle", # forma del hemiciclo
                                                       parl_rows = 4, # cantidad de filas
                                                       party_seats = senado_nomina$seats, # número de bancas 
                                                       plot_order = senado_nomina$orden) %>% #orden de partidos en hemiciclo
  mutate(colour = as.character(colour)) %>% # vector de texto para codigo HEX de colores asignados previamente
  as_tibble()

grafico_senado_por_bloque <- senadores_por_bloque %>% as_tibble() %>% 
  ggplot(aes(x, y, color = party_long, text = paste0("Nombre: ", Nombre, "<br> Apellido: ", Apellido, "\n", "Distrito: ", Distrito, "\n", "Bloque: ", party_long, "\n", "Voto: ", voto_ley_omnibus))) +
  geom_parliament_seats(size = 4) + # tamaño de bancas (puntos)
  draw_majoritythreshold(n = 36, label = F, type = "semicircle", linesize = 0.5) + # dibuja el limite de mayoría 
  scale_colour_manual(values = senado_nomina$colour, #asigno colores 
                      limits = senado_nomina$party_long)  +
  labs(title = "Honorable Senado de la Nación y su postura frente a la Ley Ómnibus",
       subtitle = "por bloque",
       x = "",
       y = "",
       caption = "Fuente: Cámara de Senadores de la Nación",
       colour = NULL) +
  theme_minimal() +
  theme(panel.grid = element_blank(), 
        axis.text = element_blank(),
        legend.text = element_text(size = 10),
        legend.position = c('bottom')
        )

grafico_senado_por_bloque

grafico_senado_por_bloque_plotly <- ggplotly(grafico_senado_por_bloque, tooltip = "text")%>%
  layout(title = list(text = paste0('Honorable Senado de la Nación y su postura frente a la Ley Ómnibus',
                                    '<br>',
                                    '<sup>',
                                    'por bloque',
                                    '</sup>')),
         legend = list(orientation = "h", x = 0, y = -0.05), 
                                           annotations = list(x = 1, 
                                                              y = -0.04,
                                                              text = "Fuente: Cámara de Senadores de la Nación",
                                                              showarrow = F,
                                                              xref='paper', yref='paper',
                                                              xanchor='right', yanchor='auto',
                                                              xshift=0, yshift=0,
                                                              font=list(size=12, color="black")))

grafico_senado_por_bloque_plotly

```


### Cámara de Senadores dividida POR VOTO


```{r, echo=FALSE}

knitr::opts_chunk$set(echo = FALSE)

library(ggparliament)
senado_nomina <- read_excel("C:/Users/fefen/OneDrive/Documentos/RSTUDIO/data/DIPUTADOS/senado_nomina.xlsx")

#NOMBRES DE COLUMNAS
colnames(senado_nomina)[1] <- "Distrito"
colnames(senado_nomina)[2] <- "Nombre"
colnames(senado_nomina)[3] <- "Apellido"
colnames(senado_nomina)[4] <- "party_long"

senado_nomina <- senado_nomina %>% mutate(
     seats = case_when(
       voto_ley_omnibus == "A favor"        ~ "1",
       voto_ley_omnibus == "Posible a favor"        ~ "1",
       voto_ley_omnibus == "En negociación"        ~ "1",
       voto_ley_omnibus == "Indefinido"        ~ "1",
      voto_ley_omnibus == "Posible en contra"        ~ "1",
       voto_ley_omnibus == "En contra"        ~ "1",
       ))

senado_nomina$seats <- as.double(senado_nomina$seats)

senado_nomina <- senado_nomina %>% mutate(
     colour = case_when(
       voto_ley_omnibus == "A favor"        ~ "#90DB7D",
       voto_ley_omnibus == "Posible a favor"        ~ "#C4FFB5",
       voto_ley_omnibus == "En negociación"        ~ "#B5C4FF",
       voto_ley_omnibus == "Indefinido"        ~ "#A1A1A1",
      voto_ley_omnibus == "Posible en contra"        ~ "#F5978F",
       voto_ley_omnibus == "En contra"        ~ "#F95D50",
       ))

senado_nomina <- senado_nomina %>% mutate(
     orden = case_when(
      voto_ley_omnibus== "A favor"        ~ "1",
       voto_ley_omnibus == "Posible a favor"        ~ "2",
       voto_ley_omnibus == "En negociación"        ~ "3",
       voto_ley_omnibus == "Indefinido"        ~ "4",
      voto_ley_omnibus == "Posible en contra"        ~ "5",
       voto_ley_omnibus == "En contra"        ~ "6",
       ))

senado_nomina$orden <- as.double(senado_nomina$orden)

senado_nomina$voto_ley_omnibus <- factor(as.character(senado_nomina$voto_ley_omnibus), levels=c("A favor", "Posible a favor", "En negociación", "Indefinido", "Posible en contra", "En contra"), labels = c("A favor", "Posible a favor", "En negociación", "Indefinido", "Posible en contra", "En contra"))

senadores_por_voto<- ggparliament::parliament_data(senado_nomina, #datos 
                                                       type = "semicircle", # forma del hemiciclo
                                                       parl_rows = 4, # cantidad de filas
                                                       party_seats = senado_nomina$seats, # número de bancas 
                                                       plot_order = senado_nomina$orden) %>% #orden de partidos en hemiciclo
  mutate(colour = as.character(colour)) %>% # vector de texto para codigo HEX de colores asignados previamente
  as_tibble()

grafico_senado_por_voto <- senadores_por_voto %>% as_tibble() %>% 
  ggplot(aes(x, y, color = voto_ley_omnibus, text = paste0("Nombre: ", Nombre, "<br>Apellido: ", Apellido, "\n", "Distrito: ", Distrito, "\n", "Bloque: ", party_long , "\n", "Voto: ", voto_ley_omnibus))) +
  geom_parliament_seats(size = 4) +
  draw_majoritythreshold(n = 128, label = F, type = "semicircle", linesize = 0.5) +
  scale_y_continuous(labels = scales::percent) +
  scale_colour_manual(values = senado_nomina$colour, # Utiliza la columna de colores
                      limits = senado_nomina$voto_ley_omnibus) +
  labs(title = "Honorable Senado de la Nación y su postura frente a la Ley Ómnibus",
       subtitle = "por voto",
       x = "",
       y = "",
       caption = "Fuente: Cámara de Senadores de la Nación",
       colour = NULL) +
  theme_minimal() +
  theme(panel.grid = element_blank(), 
        axis.text = element_blank(),
        legend.text = element_text(size = 10),
        legend.position = c('bottom'))

grafico_senado_por_voto

grafico_senado_por_voto_plotly <- ggplotly(grafico_senado_por_voto, tooltip = "text")%>%
  layout(title = list(text = paste0('Honorable Senado de la Nación y su postura frente a la ley Ómnibus',
                                    '<br>',
                                    '<sup>',
                                    'por voto',
                                    '</sup>')),
         legend = list(orientation = "h", x = 0, y = -0.05), 
                                           annotations = list(x = 1, 
                                                              y = -0.04,
                                                              text = "Fuente: Cámara de Senadores de la Nación",
                                                              showarrow = F,
                                                              xref='paper', yref='paper',
                                                              xanchor='right', yanchor='auto',
                                                              xshift=0, yshift=0,
                                                              font=list(size=12, color="black")))
grafico_senado_por_voto_plotly
```

por Frankiturr0